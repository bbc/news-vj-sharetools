define("ShareTools",["sharetools/model","sharetools/view"],function(e,t){var n=function(n){this.options=n,this.model=new e,this.view=new t({model:this.model,controller:this,config:n}),this.init()};return n.prototype={init:function(){this.setMessages(this.options.messages),this.setShareUrl(this.options.shareUrl)},setShareUrl:function(e){this.model.setShareUrl(e)},setMessages:function(e){this.model.setFacebookMessage(e.facebook),this.model.setTwitterMessage(e.twitter),this.model.setEmailMessage(e.email)},openShareWindow:function(e){var t=this.getShareTargetUrl(e),n=this.getNetworkConfig(e);n.popup?window.open(t,"_blank","width=626,height=235"):window.location.href=t},getShareTargetUrl:function(e){var t=this.getNetworkConfig(e),n=this.getNetworkParameters(t),r=this.buildQueryStringFrom(n);return t.shareEndpoint+r},buildQueryStringFrom:function(e){var t="?";for(var n in e)if(e.hasOwnProperty(n)){var r=e[n];t+=n+"="+encodeURIComponent(r)+"&"}return t.slice(0,-1)},getNetworkParameters:function(e){var t=e.staticParameters||{};for(var n in e.dynamicParameters)e.dynamicParameters.hasOwnProperty(n)&&(t[n]=e.dynamicParameters[n]());return t},getNetworkConfigList:function(){var e=this;return[{name:"facebook",shareEndpoint:"https://www.facebook.com/dialog/feed",popup:!0,staticParameters:{app_id:"58567469885",redirect_uri:"http://www.bbc.co.uk/news/special/shared/vj_sharetools/fb_red_uri.html?st_cb=facebook#state=feed",display:"popup",locale:"en_GB"},dynamicParameters:{link:function(){return e.model.getShareUrl()},name:function(){return e.model.getFacebookMessage().title},description:function(){return e.model.getFacebookMessage().description},picture:function(){return e.model.getFacebookMessage().image}}},{name:"twitter",shareEndpoint:"https://twitter.com/intent/tweet",popup:!0,dynamicParameters:{text:function(){return e.model.getTwitterMessage()+" "+e.model.getShareUrl()}}},{name:"email",shareEndpoint:"mailto:",popup:!1,dynamicParameters:{subject:function(){return e.model.getEmailMessage().subject},body:function(){return e.model.getEmailMessage().message+" "+e.model.getShareUrl()}}}]},getNetworkConfig:function(e){var t=this.getNetworkConfigList();for(var n=0;n<t.length;n++){var r=t[n];if(r.name===e)return r}return null},getNetworks:function(){var e=this.getNetworkConfigList(),t=[];for(var n=0;n<e.length;n++)t.push(e[n].name);return t}},n}),define("sharetools/controller",function(){});